# SYN Response Analyzer (Scapy)

[![License: GPL-3.0](https://img.shields.io/badge/license-GPLv3-green.svg)](https://opensource.org/licenses/GPL-3.0)
[![Python 3.8+](https://img.shields.io/badge/python-3.8+-blue.svg)](https://www.python.org/downloads/)
[![Scapy](https://img.shields.io/badge/scapy-latest-orange.svg)](https://scapy.net/)

A lightweight **Python + Scapy** tool that analyzes how outbound TCP connection attempts are handled on the network path â€” distinguishing between **accepted**, **rejected**, **blocked**, and **silently dropped** connections.

This is **not a scanner** or exploit tool.  
It observes **real traffic generated by your system** and classifies the responses.

---

## ğŸ” What This Tool Answers

When your system initiates TCP connections, what actually happens?

- âœ… Is the target **open and reachable**?
- âŒ Is the target **actively rejecting** connections (TCP RST)?
- ğŸš« Is a **router or firewall blocking** traffic (ICMP Unreachable)?
- ğŸ•³ï¸ Are packets being **silently dropped** (no response)?

This tool gives **evidence-based answers** using packet-level inspection.

---

## ğŸ§  How It Works

1. Tracks **outbound TCP SYN packets** sent by your host  
2. Correlates inbound responses by 4-tuple:
   - Destination IP
   - Destination port
   - Source port
3. Classifies responses as:
   - **SYN/ACK** â†’ connection accepted
   - **RST** â†’ connection rejected
   - **ICMP Type 3** â†’ network / policy unreachable
   - **Timeout** â†’ filtered or dropped

---

## ğŸ“Š Output Metrics

The script reports:

- SYNs sent
- SYN/ACK received (allowed)
- RST received (rejected)
- ICMP Unreachable (by code)
- Timeouts (no response)

Example conclusion output:

```
Conclusion: Most attempts got no response (possible filtering or silent drops).
```

---

## ğŸ§° Requirements

- Python **3.8+**
- Scapy
- Root / Administrator privileges (packet capture required)

### Install dependencies:

```bash
pip install scapy
```

---

## â–¶ï¸ Usage

### Run with elevated privileges:

```bash
sudo python3 syn_response_analyzer.py
```

### Generate traffic in another terminal:

```bash
curl https://example.com
```

Or open a browser and load multiple sites.

Press `Ctrl+C` to stop capture and view results.

---

## ğŸ§ª ICMP Code Reference (Common)

| Code | Meaning |
|------|---------|
| 0 | Network unreachable |
| 1 | Host unreachable |
| 3 | Port unreachable |
| 10 | Communication administratively prohibited |
| 13 | Administratively prohibited (firewall) |

> ğŸ“ **Note**: Codes 10 and 13 often indicate explicit firewall policy blocks.

---

## âš ï¸ Limitations

- NAT or upstream firewalls may suppress ICMP messages
- Timeouts â‰  guaranteed blocking (could be loss or rate limiting)
- Does not attempt retries or retransmission analysis
- Observes traffic â€” does not generate probes itself

---

## ğŸ” Ethical Use Notice

This tool is intended for:

- Network diagnostics
- Firewall policy validation
- Defensive security research
- Infrastructure troubleshooting

> âš ï¸ **Important**: Only run on systems and networks you own or are authorized to test.

---

## ğŸ§© Contributing

Contributions are welcome! To participate:

1. Fork the repository
2. Create a feature branch: `git checkout -b feature/your-enhancement`
3. Commit your changes: `git commit -m "Add: your feature"`
4. Push to your fork: `git push origin feature/your-enhancement`
5. Open a Pull Request

See [CONTRIBUTING.md](CONTRIBUTING.md) for detailed guidelines.

---

## ğŸ› Issues & Support

Found a bug or have a feature request? Please [open an issue](https://github.com/AfterPacket/SYN-Response-Analyzer/issues) with:

- Steps to reproduce
- Expected vs actual behavior
- Python and Scapy versions
- Operating system

---

## ğŸ“„ License

This project is licensed under the **GNU General Public License v3.0**.  
See the [LICENSE](LICENSE) file for full details.

---

## âœï¸ Author

**AfterPacket**  
ğŸ”— https://github.com/AfterPacket

---

## ğŸ™Œ Acknowledgements

- Built with [Scapy](https://scapy.net/) - the powerful Python packet manipulation library
- Inspired by network troubleshooting and security research needs
- Thanks to the open-source community

---

## ğŸ“š Additional Resources

- [Scapy Documentation](https://scapy.readthedocs.io/)
- [TCP/IP Illustrated](https://en.wikipedia.org/wiki/TCP/IP_Illustrated)
- [ICMP RFC 792](https://tools.ietf.org/html/rfc792)
- [TCP RFC 793](https://tools.ietf.org/html/rfc793)

---

**Happy Network Analyzing!** ğŸ”ğŸ“¡
